# EMG_analysis

## 各プログラムの目的
| プログラムファイル名 | 目的 |
| --- | --- |
| EMG.m | 筋電図波形のプロット |
| RMS.m | RMS波形のプロット |
| MVC.m | MVCの算出 |
| PercentMVC.m | %MVCの算出 |
| IEMG.m | IEMGの算出 |
| MPF.m | 平均周波数の算出 |

## 使用上の注意
- 解析の際は，解析対象のCSVファイルをプログラムファイルと同じディレクトリに置いてください。
- 複数のCSVファイルを連続で処理するプログラムは，5secのデータと120secのデータを同時に処理できないので，分けて処理してください。
  - 120secのデータ処理時は120secのデータのみ、プログラムファイルと同じディレクトリに置いてください。
  - 5secのデータ処理時は5secのデータのみ、プログラムファイルと同じディレクトリに置いてください。

## 使用方法

### EMG.m
1. 120secの場合は、処理したい120secのcsvを全て、プログラムファイルと同じディレクトリに置く。このとき、5secのcsvが同じディレクトリに存在しないようにする。
      1. 5secの場合は、処理したい5secのcsvを全て、プログラムファイルと同じディレクトリに置く。このとき、120secのcsvが同じディレクトリに存在しないようにする。
2. 120secの場合は、プログラム内の計測時間を120sec、x軸目盛り幅を10secにする。
   1. 5secの場合は、計測時間を5sec、x軸目盛り幅を1secにする。
3. プログラムを実行すると、同じディレクトリに連続で各データのプロットの画像ファイルが生成される。ファイル名は対応するcsv名と同じになっている。
4. コメントで「入力：」と書いてある部分は調節できる場所なので、プロットの設定などは適宜調節する。

### RMS.m
1. EMG.mの平滑化バージョンなので、使い方は同じ。

### IEMG.m
1. 使い方はEMG.mと同じだが、出力結果はグラフではなく値なので、ワークスペースから値を読み取る必要がある。
2. プログラム実行後、MATLABのワークスペース（左下のプログラムで登場した変数の名前と値がまとめられている部分）からIEMG_tableを見つけて、ダブルクリックする。
3. 別タブでIEMG_tableの中身の表が開く。1列目のname列はcsvの名前、2列目のiemg列は全区間のIEMG、3列目以降は設定した時間刻み幅で区切った時間変化IEMGなので、値を読み取る。
4. デフォルトの時間刻み幅は30secになっているので、IEMG_tableの3列目は0から30sec、4列目は30から60sec、5列目は60から90sec、6列目は90から120secのIEMGを示す。
5. 時間刻み幅はプログラム内で変更可能。ただし、刻んだ区間の総数が設定したtableのサイズを超える場合は、プログラム内のtable作成部分を変更してより大きいtableを作成しておく。

### MVC.m
1. EMG.mのように複数csvを一括で処理できないので、処理したいファイル名を適宜プログラム内に入力する。
2. 処理するのは5sec（最大筋力発揮時）のデータ。
3. プログラム実行後、ワークスペースからMAXの値を読み取る。

### PercentMVC.m
1. MVC.mと同じく、複数csvを一括で処理できないので、処理したいファイル名を適宜プログラム内に入力する。
2. 処理するのは、120sec（スーツ装着時）のデータ。
3. 同じ実験協力者の5secのデータからMVC.mを用いて算出したMAXの値をプログラム内に入力する。
4. プログラムを実行すると、同じディレクトリにプロットの画像ファイルが生成される。ファイル名はcsv名と同じ。

### MPF.m
1. IEMG.mと使い方は同じ。
2. プログラム実行後、MATLABのワークスペースからMPF_tableを見つけて、ダブルクリックする。
3. 別タブでMPF_tableの中身の表が開く。1列目のname列はcsvの名前、2列目以降は設定した時間刻み幅で区切った時間変化MPFなので、値を読み取る。
